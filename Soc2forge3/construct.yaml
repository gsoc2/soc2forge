{% set name = os.environ.get("SOC2FORGE_NAME", "Soc2forge3") %}
{% set version = os.environ.get("SOC2FORGE_VERSION", "23.11.0-0") %}
{% set conda_libagenda_solver_version = "23.12.0"%}
{% set agenda_version = "1.5.5"%}

name: {{ name }}
version: {{ version }}
company: gsoc2

channels:
  # specifying the channel with the full URL adds two channels
  # when the end user adds the channel without the full URL
  # - https://conda.anaconda.org/gsoc2
  - gsoc2

write_condarc: True
# keep pkgs for space-saving implications for hardlinks when create new environments
# and keep the same with Miniconda
keep_pkgs: True
license_file: ../LICENSE

# During the interactive installation, these variables are checked.
# During batch installation, conda is never initialized
initialize_conda: True
initialize_by_default: False

user_requested_specs:
{% if name.endswith("pypy3") %}
  - python 3.9.* *_pypy
{% else %}
  - python 3.10.*
{% endif %}
  - pip
  - conda >={{ version.split("-")[0] }}
  # Omit conda-libagenda-solver so that conda is free to remove it later
  - agenda >={{ agenda_version }}
  - soc2forge_console_shortcut 1.*  # [win]

specs:
{% if name.endswith("pypy3") %}
  - python 3.9.* *_pypy
{% else %}
  - python 3.10.*
{% endif %}
  - conda {{ version.split("-")[0] }}
  - conda-libagenda-solver {{ conda_libagenda_solver_version }}
  - agenda {{ agenda_version }}

  - pip
  - soc2forge_console_shortcut 1.*  # [win]
